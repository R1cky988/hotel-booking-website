<!--<!DOCTYPE html>-->
<!--<html xmlns:th="http://www.thymeleaf.org">  <head>-->
<!--    <meta charset="UTF-8" />-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0" />-->
<!--    <title>Đánh giá khách sạn</title>-->
<!--    &lt;!&ndash; Thêm liên kết tới Bootstrap và Font Awesome &ndash;&gt;-->
<!--    <link-->
<!--      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"-->
<!--      rel="stylesheet"-->
<!--    />-->
<!--    <link-->
<!--      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"-->
<!--      rel="stylesheet"-->
<!--    />-->
<!--    <style>-->
<!--      body {-->
<!--        font-family: Arial, sans-serif;-->
<!--        background-color: #f4f6f9;-->
<!--      }-->
<!--      .modal-content {-->
<!--        border-radius: 8px;-->
<!--        padding: 20px;-->
<!--      }-->
<!--      #feedbackModal .modal-dialog {-->
<!--        max-width: 80%;-->
<!--      }-->
<!--      .form-group h5 {-->
<!--        font-size: 20px;-->
<!--        font-weight: 700;-->
<!--        text-align: center;-->
<!--        margin-bottom: 20px;-->
<!--        color: #18528f;-->
<!--      }-->
<!--      .btn-primary {-->
<!--        width: 100%;-->
<!--        font-size: 16px;-->
<!--        background-color: #0f4c8d;-->
<!--      }-->
<!--      .form-group {-->
<!--        margin-bottom: 10px;-->
<!--      }-->
<!--      .form-control {-->
<!--        border-radius: 8px;-->
<!--      }-->
<!--    </style>-->
<!--  </head>-->
<!--  <body>-->
<!--    <div-->
<!--      class="container d-flex justify-content-center align-items-center"-->
<!--      style="height: 100vh"-->
<!--    >-->
<!--      &lt;!&ndash; Modal Form &ndash;&gt;-->
<!--      <div-->
<!--        class="modal-content shadow-lg"-->
<!--        style="max-width: 350px; width: 100%"-->
<!--      >-->
<!--        <div class="modal-body">-->
<!--          <form>-->
<!--            <div class="form-group">-->
<!--              <h5>Mã số đặt phòng</h5>-->
<!--              <input-->
<!--                type="text"-->
<!--                class="form-control"-->
<!--                placeholder="Nhập mã số đặt phòng"-->
<!--                required-->
<!--              />-->
<!--            </div>-->
<!--            <p-->
<!--              style="-->
<!--                font-size: 12px;-->
<!--                font-style: italic;-->
<!--                color: #7a7a7a;-->
<!--                margin-left: 10px;-->
<!--              "-->
<!--            >-->
<!--              Mã số đặt phòng được gửi trong email của bạn-->
<!--            </p>-->
<!--          </form>-->

<!--          &lt;!&ndash; <button type="submit" class="btn btn-primary" id="goToFeedbackDetail">-->
<!--            Đến trang đánh giá-->
<!--          </button> &ndash;&gt;-->
<!--        </div>-->
<!--      </div>-->
<!--    </div>-->
<!--    &lt;!&ndash; Modal đánh giá&ndash;&gt;-->
<!--    <div-->
<!--      class="modal fade"-->
<!--      id="feedbackModal"-->
<!--      tabindex="-1"-->
<!--      aria-labelledby="feedbackModalLabel"-->
<!--      aria-hidden="true"-->
<!--    >-->
<!--      <div class="modal-dialog modal-lg">-->
<!--        <div class="modal-content">-->
<!--          <div class="modal-header">-->
<!--            <h5 class="modal-title">Đánh giá của bạn</h5>-->
<!--            <button-->
<!--              type="button"-->
<!--              class="btn-close"-->
<!--              data-bs-dismiss="modal"-->
<!--              aria-label="Close"-->
<!--            ></button>-->
<!--          </div>-->
<!--          <div class="modal-body">-->
<!--            &lt;!&ndash; Nội dung từ FeedbackDetail.html sẽ được tải vào đây &ndash;&gt;-->
<!--            <iframe-->
<!--              src="FormFeedback.html"-->
<!--              style="width: 100%; height: 560px; border: none"-->
<!--            ></iframe>-->
<!--          </div>-->
<!--        </div>-->
<!--      </div>-->
<!--    </div>-->
<!--    &lt;!&ndash; Thêm script để sử dụng Bootstrap JS &ndash;&gt;-->
<!--    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>-->
<!--    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>-->
<!--  </body>-->
<!--</html>-->


<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Đánh giá</title>
  <link
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
          crossorigin="anonymous"
  />
  <link
          rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
  />
  <link
          href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap"
          rel="stylesheet"
  />
  <link th:href="@{/Css/navbar.css}" rel="stylesheet"/>
  <style>
    body {
      font-family: "Roboto", sans-serif;
      display: grid;
      justify-content: center;
    }

    .form-label {
      margin-left: 5px;
      color: #18528f;
      font-weight: 700;
    }
    .rating i {
      color: #ffc107;
      height: 30px;
      width: 30px;
    }
    .btn-primary {
      color: white;
      background-color: #0056b3;
    }
    .modal-content {
      border-radius: 20px;
      padding: 10px 50px;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      max-width: 1000px;
      width: 90%;
      /* background-color: #0056b3; */
    }
    .form-control {
      width: 100%;
    }
  </style>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-light fixed-top">
  <div class="container-fluid" style="max-height: 30px">
    <a class="navbar-brand" th:href="@{/index}"> TravelBooking </a>
    <button
            aria-controls="navbarNav"
            aria-expanded="false"
            aria-label="Toggle navigation"
            class="navbar-toggler"
            data-bs-target="#navbarNav"
            data-bs-toggle="collapse"
            type="button"
    >
      <span class="navbar-toggler-icon"> </span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto">
        <!-- <li class="nav-item">
          <a class="nav-link" href="#">
            <i class="fas fa-search"> </i> ICON TÌM KIẾM
          </a>
        </li> -->
        <li class="nav-item">
          <a class="nav-link" th:href="@{/index}"> HOME </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" th:href="@{index#popular}"> POPULAR </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" th:href="@{index#explore}"> EXPLORE </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" th:href="@{index#review}"> REVIEW </a>
        </li>
        <div class="vertical-line1"></div>

        <div th:if="${session.user != null}" class="user-info d-flex">

          <a class="nav-link" style="color: #fff; text-decoration: none;"
             th:href="@{http://localhost:8088/booking/{userId}(userId=${session.user.id})}"
          >
            <span th:text="${session.user.firstName}"></span>
            <span th:text="${session.user.lastName}"></span>
          </a>

          <li class="nav-item">
            <a
                    class="nav-link"
                    href="/users/logout"
                    style="color: #ffffff"
                    onmouseover="this.style.color='433e3e'"
                    onmouseout="this.style.color='#ff3b3f'"
            >
              SIGN OUT
            </a>
          </li>
        </div>

        <div th:if="${session.user == null}" class="login-form d-flex">
          <li class="nav-item">
            <a
                    class="nav-link"
                    href="/users/login"
                    style="color: #f9f9f9"
                    onmouseover="this.style.color='433e3e'"
                    onmouseout="this.style.color='#ff3b3f'"
            >
              SIGN IN
            </a>
          </li>
          <li class="nav-item">
            <a
                    class="nav-link"
                    href="/users/register"
                    style="color: #ffffff"
                    onmouseover="this.style.color='433e3e'"
                    onmouseout="this.style.color='#ff3b3f'"
            >
              SIGN UP
            </a>
          </li>
        </div>
      </ul>
    </div>
  </div>
</nav>

<div class="container-fluid">
  <div class="row">
    <div class="col-12 col-lg-10 mx-auto">
      <div class="modal-content mt-5">
        <h2
                class="text-center mb-4"
                style="color: rgb(18, 74, 133); font-weight: 700"
        >
          Đánh giá trải nghiệm của bạn
        </h2>
        <form th:action="@{/feedback1}" method="post" th:object="${feedbackDetailDTO}"
              style="background: #f7f7f7; padding: 20px">
          <div th:if="${errors}" class="alert alert-danger">
            <li th:each="error : ${errors}" th:text="${error}"></li>
          </div>
          <div th:if="${error}" class="alert alert-danger">
            <p th:text="${error}"></p>
          </div>
          <input
                  type="hidden"
                  th:field="*{feedbackSummaryId}"
                  th:value="${feedbackDetailDTO.feedbackSummaryId}"
          />
          <input
                  type="hidden"
                  th:field="*{userId}"
                  th:value="${feedbackDetailDTO.userId}"
          />
          <input
                  type="hidden"
                  name="hotelId"
                  th:value="${hotelId}"
          />

          <label for="roomName" class="form-label">Tên phòng</label>
          <select
                  id="roomName"
                  class="form-select"
                  aria-label="Chọn tên phòng"
                  th:field="*{roomName}">
            <option value="" disabled selected>Chọn phòng</option>
            <option th:each="room : ${roomNames}" th:value="${room}" th:text="${room}"></option>
          </select>
          <div class="mb-3">
            <label for="name" class="form-label">Tên của bạn</label>
            <input
                    type="text"
                    class="form-control"
                    id="name"
                    name="name"
                    placeholder="Nhập tên của bạn"
                    th:field="*{name}"
            />
          </div>
          <div class="mb-3">
            <label for="email" class="form-label">Email</label>
            <input
                    type="text"
                    class="form-control"
                    id="email"
                    name="email"
                    placeholder="Nhập email của bạn"
                    th:field="*{email}"
            />
          </div>
          <div class="mb-3">
            <label for="comments" class="form-label">Bình luận</label>
            <textarea
                    class="form-control"
                    id="comments"
                    name="comments"
                    rows="4"
                    placeholder="Nhập bình luận của bạn"
                    th:field="*{comment}"
            ></textarea>
          </div>
          <div class="mb-3">
            <div class="mb-3">
              <div class="rating">
                <label
                        for="rating"
                        class="form-label"
                        style="margin-right: 20px"
                >Xếp hạng:</label
                >
                <i class="fas fa-star" th:each="i : ${#numbers.sequence(1, 5)}"
                   th:classappend="${i <= selectedRating ? 'selected' : ''}"
                   th:data-value="${i}"></i>

                <!-- Hidden input bound to the model -->
                <input type="hidden" id="rating" name="rating" th:value="${selectedRating}">
              </div>
            </div>
          </div>
          <button type="submit" class="btn btn-primary">
            Gửi đánh giá
          </button>
        </form>
      </div>
    </div>
  </div>
</div>

<script>
  document.querySelectorAll(".rating i").forEach((star) => {
star.addEventListener("click", function () {
const value = parseInt(this.getAttribute("data-value"), 10);

// Update the selected class for stars
document.querySelectorAll(".rating i").forEach((s) => {
  s.classList.remove("selected");
  if (parseInt(s.getAttribute("data-value"), 10) <= value) {
    s.classList.add("selected");
  }
});

// Update the hidden input field with the rating value
document.getElementById("rating").value = value;
});
});

</script>
<script>
  <!--      // Bắt sự kiện khi form được gửi-->
  <!--      document-->
  <!--        .getElementById("feedbackForm")-->
  <!--        .addEventListener("submit", async function (event) {-->
  <!--          event.preventDefault(); // Ngăn tải lại trang-->

  <!--          // Lấy dữ liệu từ form-->
  <!--          const name = document.getElementById("name").value.trim();-->
  <!--          const email = document.getElementById("email").value.trim();-->
  <!--          const comments = document.getElementById("comments").value.trim();-->

  <!--          // Lấy rating từ các ngôi sao-->
  <!--          const ratingElements = document.querySelectorAll(".rating i");-->
  <!--          let rating = 0;-->
  <!--          ratingElements.forEach((star) => {-->
  <!--            if (star.classList.contains("selected")) {-->
  <!--              rating = Math.max(-->
  <!--                rating,-->
  <!--                parseInt(star.getAttribute("data-value"), 10)-->
  <!--              );-->
  <!--            }-->
  <!--          });-->

  <!--          // Kiểm tra dữ liệu đầu vào-->
  <!--          if (!name) {-->
  <!--            alert("Vui lòng nhập tên của bạn!");-->
  <!--            return;-->
  <!--          }-->
  <!--          if (!email || !email.includes("@")) {-->
  <!--            alert("Vui lòng nhập địa chỉ email hợp lệ!");-->
  <!--            return;-->
  <!--          }-->
  <!--          if (!comments) {-->
  <!--            alert("Vui lòng nhập nội dung bình luận!");-->
  <!--            return;-->
  <!--          }-->
  <!--          if (rating === 0) {-->
  <!--            alert("Vui lòng chọn xếp hạng!");-->
  <!--            return;-->
  <!--          }-->

  <!--          // Dữ liệu gửi lên server-->
  <!--          const feedbackData = {-->
  <!--            bookingId: 1, // Thay bằng ID đặt chỗ cụ thể nếu cần-->
  <!--            feedbackText: comments,-->
  <!--            rating: rating,-->
  <!--          };-->

  <!--          // Xử lý trạng thái nút gửi-->
  <!--          const submitButton = document.querySelector("button[type='submit']");-->
  <!--          submitButton.disabled = true;-->
  <!--          submitButton.innerText = "Đang gửi...";-->

  <!--          try {-->
  <!--            // Gửi request tới API-->
  <!--            const response = await fetch("http://localhost:8080/feedback", {-->
  <!--              method: "POST",-->
  <!--              headers: {-->
  <!--                "Content-Type": "application/json",-->
  <!--              },-->
  <!--              body: JSON.stringify(feedbackData),-->
  <!--            });-->

  <!--            // Xử lý kết quả từ API-->
  <!--            if (!response.ok) {-->
  <!--              const errorData = await response.json();-->
  <!--              alert(-->
  <!--                "Lỗi: " +-->
  <!--                  (Array.isArray(errorData) ? errorData.join(", ") : errorData)-->
  <!--              );-->
  <!--              return;-->
  <!--            }-->

  <!--            const result = await response.json();-->
  <!--            alert("Đánh giá của bạn đã được gửi thành công!");-->
  <!--            console.log(result);-->

  <!--            // Reset form sau khi gửi thành công-->
  <!--            document.getElementById("feedbackForm").reset();-->
  <!--            ratingElements.forEach((star) => star.classList.remove("selected"));-->
  <!--          } catch (error) {-->
  <!--            console.error("Lỗi khi kết nối tới server:", error);-->
  <!--            alert("Không thể gửi đánh giá. Vui lòng thử lại sau.");-->
  <!--          } finally {-->
  <!--            // Khôi phục trạng thái nút gửi-->
  <!--            submitButton.disabled = false;-->
  <!--            submitButton.innerText = "Gửi đánh giá";-->
  <!--          }-->
  <!--        });-->

        // Xử lý hiệu ứng chọn sao (rating)
        document.querySelectorAll(".rating i").forEach((star) => {
          star.addEventListener("mouseover", function () {
            const value = parseInt(this.getAttribute("data-value"), 10);
            document.querySelectorAll(".rating i").forEach((s) => {
              s.style.color = parseInt(s.getAttribute("data-value"), 10) <= value ? "#ffc107" : "#ddd";
            });
          });

                star.addEventListener("click", function () {
                  // Chọn sao khi click
                  const value = parseInt(this.getAttribute("data-value"), 10);
                  document.querySelectorAll(".rating i").forEach((s) => {
                    s.classList.remove("selected");
                    if (parseInt(s.getAttribute("data-value"), 10) <= value) {
                      s.classList.add("selected");
                    }
                  });
                });

                // Đặt lại màu khi chuột rời khỏi rating
                star.addEventListener("mouseout", function () {
            const selectedRating = document.querySelectorAll(".rating i.selected").length;
            document.querySelectorAll(".rating i").forEach((s) => {
              s.style.color = s.classList.contains("selected") ? "#ffc107" : "#ddd";
            });
          });
        });
</script>
</body>
</html>

